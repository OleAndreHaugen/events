{
	"id": "d0267c8d-4f96-43d3-b5b8-99c12c0c2779",
	"createdAt": "2022-06-12T12:09:20.000Z",
	"createdBy": "ole-andre.haugen@neptune-software.com",
	"globalScripts": [],
	"externalModules": [],
	"entitySets": [
		{
			"id": "269d7a83-4cc0-4688-a58a-913787ab0096",
			"name": "event_organisation",
			"contextname": "event_organisation"
		}
	],
	"apis": [],
	"name": "import",
	"ver": "22.6.12.1456",
	"description": null,
	"content": [
		"==OBJECT STRING==",
		"req.body.forEach(async function (data, index, array) {\r",
		"\r",
		"    // Map data from Enhetsregisteret to DB\r",
		"    let dbRec = {\r",
		"        organisasjonsnummer: data.organisasjonsnummer,\r",
		"        navn: data.navn,\r",
		"        organisasjonsform_kode: data.organisasjonsform.kode,\r",
		"        organisasjonsform_navn: data.organisasjonsform.beskrivelse,\r",
		"        registreringsdatoEnhetsregisteret: data.registreringsdatoEnhetsregisteret,\r",
		"        registrertIMvaregisteret: data.registrertIMvaregisteret,\r",
		"        naeringskode1_kode: data.naeringskode1.kode,\r",
		"        naeringskode1_navn: data.naeringskode1.beskrivelse,\r",
		"        antallAnsatte: data.antallAnsatte,\r",
		"        forretningsadresse_land: data.forretningsadresse.land,\r",
		"        forretningsadresse_landkode: data.forretningsadresse.landkode,\r",
		"        forretningsadresse_postnummer: data.forretningsadresse.postnummer,\r",
		"        forretningsadresse_poststed: data.forretningsadresse.poststed,\r",
		"        forretningsadresse_kommune: data.forretningsadresse.kommune,\r",
		"        forretningsadresse_kommunenummer: data.forretningsadresse.kommunenummer,\r",
		"        stiftelsesdato: data.stiftelsesdato,\r",
		"        institusjonellSektorkode_kode: data.institusjonellSektorkode.kode,\r",
		"        institusjonellSektorkode_navn: data.institusjonellSektorkode.beskrivelse\r",
		"    }\r",
		"\r",
		"    if (data.forretningsadresse.adresse[0]) dbRec.forretningsadresse_adresse1 = data.forretningsadresse.adresse[0];\r",
		"    if (data.forretningsadresse.adresse[1]) dbRec.forretningsadresse_adresse2 = data.forretningsadresse.adresse[1];\r",
		"    if (data.forretningsadresse.adresse[2]) dbRec.forretningsadresse_adresse3 = data.forretningsadresse.adresse[2];\r",
		"    if (data.forretningsadresse.adresse[3]) dbRec.forretningsadresse_adresse4 = data.forretningsadresse.adresse[3];\r",
		"\r",
		"    // Exists ? \r",
		"    const enhet = await entities.event_organisation.findOne({ organisasjonsnummer: data.organisasjonsnummer });\r",
		"    if (enhet) dbRec.id = enhet.id;\r",
		"\r",
		"    // Save/Update\r",
		"    await entities.event_organisation.save(dbRec);\r",
		"\r",
		"});\r",
		"\r",
		"result.data = {\r",
		"    status: \"OK\",\r",
		"    text: \"Importert og oppdatert \" + req.body.length + \" enheter\"\r",
		"}\r",
		"\r",
		"complete();\r",
		""
	],
	"useAsGlobalScript": false,
	"isTypescript": false,
	"transpiledContent": null,
	"lastRunSuccessful": false,
	"jsscriptGroup": "3b6f01ae-36a9-4616-838e-5644ffef987c",
	"package": "3f97e980-7613-4613-b374-7ad2f7f76664"
}